<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=.7, maximum-scale=1, user-scalable=no">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"> -->

    <title>Birl!</title>

    <style>
        #birlButton {
            cursor: pointer;
            background: url(img/bodybuilder2_peso.jpg) no-repeat 100% 100% ;
            background-position: center;
            width: 500px;
            height: 500px;
            margin: 0 auto;
            display: block;
        }

        #birlInit {
            width: 300px;
            height: 50px;
            font-size: 20px;
            margin: 0 auto;
            display: block;
        }
    </style>
</head>
<body>
    <div style="font-size: 50px">Birl Counter: <span id="birlCounter">0</span></div>
    <div style="font-size: 50px">Birl Level: <span id="birlLevel">1</span></div>

    <button id="birlInit">Restart</button> <br>
    <div id="birlButton"></div>

    <audio id="birl">
        <source src="audio/birl.mp3" type="audio/mpeg">
    </audio>
    <audio id="show">
        <source src="audio/show.mp3" type="audio/mpeg">
    </audio>
    <audio id="negativa">
        <source src="audio/negativa2.ogg" type="audio/mpeg">
    </audio>
    <audio id="bodybuilder">
        <source src="audio/bodybuilder.mp3" type="audio/mpeg">
    </audio>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script>
        jQuery(document).ready(function($) {
            const birlLimit           = 3,
                  birlMaxLevel        = 5,
                  intervalLevelUm     = null,
                  intervalLevelDois   = 4000,
                  intervalLevelTres   = 3200,
                  intervalLevelQuatro = 2500,
                  intervalLevelBoss   = 1800;

            var   audioShow           = document.getElementById("show"),
                  audioBirl           = document.getElementById("birl"),
                  audioBodybuilder    = document.getElementById("bodybuilder"),
                  audioNegativa       = document.getElementById("negativa"),
                  birlButton          = $("#birlButton"),
                  domBirlCounter      = $("#birlCounter"),
                  domBirlLevel        = $("#birlLevel");

            audioShow.play();

            var HoraDoShow = function () {
                var self = this;

                self.birlLevel   = 1;
                self.birlCounter = 0;

                self.startBirl = function (restartBirlLevel) {
                    if (restartBirlLevel)
                        self.birlLevel = 1;

                    self.birlCounter = 0;
                    domBirlCounter.text(self.birlCounter);
                    domBirlLevel.text(self.birlLevel);

                    switch (self.birlLevel) {
                        case 1:
                            self.birlInterval = null;
                            break;

                        case 2:
                            self.birlInterval = setInterval(self.decrementBirl, intervalLevelDois);
                            break;

                        case 3:
                            self.birlInterval = setInterval(self.decrementBirl, intervalLevelTres);
                            break;

                        case 4:
                            self.birlInterval = setInterval(self.decrementBirl, intervalLevelQuatro);
                            break;

                        case 5:
                            self.birlInterval = setInterval(self.decrementBirl, intervalLevelBoss);
                            break;
                    }
                };

                self.incrementBirl = function () {
                    self.birlCounter++;
                    domBirlCounter.text(self.birlCounter);

                    if (self.birlCounter < birlLimit) {
                        audioBirl.play();
                    }
                };

                self.decrementBirl = function () {
                    if (self.birlCounter > 0) {
                        self.birlCounter--;
                        audioNegativa.play();
                        domBirlCounter.text(self.birlCounter);
                    }
                };

                self.incrementBirlLevel = function (playBodybuilder) {
                    if (self.birlLevel)
                        clearInterval(self.birlInterval);

                    if (playBodybuilder)
                        audioBodybuilder.play();

                    if (self.birlLevel < birlMaxLevel) {
                        self.birlLevel++;
                        self.startBirl();
                    }

                }
            }, bambam = new HoraDoShow();

            bambam.startBirl();

            $('#birlInit').on('click', function() {
                bambam.incrementBirlLevel(false);
                bambam.startBirl(true);
            });

            birlButton.on('click', function() {
                if (bambam.birlLevel > birlMaxLevel)
                    return;

                if (bambam.birlCounter < birlLimit)
                    bambam.incrementBirl();

                if (bambam.birlCounter >= birlLimit)
                    bambam.incrementBirlLevel(true);

                birlButton.css("pointer-events", "none");
                birlButton.css("background", "url(img/bodybuilder2_peso2.jpg) no-repeat 100% 100%");
                birlButton.css("background-position", "center");

                setTimeout(function() {
                    birlButton.css("background", "url(img/bodybuilder2_peso.jpg) no-repeat 100% 100%");
                    birlButton.css("background-position", "center");
                    birlButton.css("pointer-events", "auto");
                }, 1000);
            });
        });
    </script>
</body>
</html>
